<!DOCTYPE html>
<html>
    <head>
        <title>JuDoRks Threads</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" 
integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    </head>
    <body style="background-color: rgb(39, 180, 150);" class="container">

        <h1> See All Threads</h1>
        <div id="viewer" class="row"></div>

<!------------------------------------------------------------------------------------------------------------------> 
        <script>
          
            fetch('/allThreads')
            .then(response => response.json())
            .then(data => {
                console.log(data);
       output = '';
       data.forEach(function(each){
           output += `
           <br/>
            <div class='row'>
                <div class='card' style="background-color:rgb(71, 157, 233)">
                    <p>${each.thread.content}</p>
                    <div class='row'>
                        <form id='commentForm${each.thread.id}' >
                        <input type='text' maxlength='500'id='comment${each.thread.id}' class='col-12'>
                        <button id='addComment' class='col-3'type='submit' onSubmit='addComment(${each.thread.id})' >Add Comment</button>
                        <div class='col-9'></div><button class='col-3'>View Comments</button>
                        </form>
                    </div>
                </div>
            </div>
            <br/>
           ` 
        })
        
        document.getElementById('viewer').innerHTML = output
    })
 //-----------------------------------------------------------------------------------------------------------------//            
   //function that will be used as onSubmit for add comment button, will post comment input to relative 
   //object in array 
 
    function addComment (threadId){
    commentKey = document.getElementByTag('input').value;
    newComment = {commentKey}
    fetch('/addComment/:'+threadId, {
                method: 'PUT', 
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(newComment), //request body that will show in server.js//
                })
                .then(response => response.json())
                .then(data => {
                console.log('Success:', data);
                })
                .catch((error) => {
                console.error('Error:', error);
                });

    }
       
       </script>
    </body>
</html>